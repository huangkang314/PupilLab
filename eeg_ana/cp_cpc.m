function R = cp_cpc(Cum)% cpc finds putative change points in continuous-time cumulative records% It takes as input a vector of the cumulative interevent intervals% Syntax is  R = cpc(Cum)% The Nth row of Cum gives the interval from the onset of observation to% the Nth event. The putative change point corresponding to the Nth% event is the preceding event at which the deviation of the observed event count% from the expected event count is maximal. The expected event count% at any earlier event, n, is Cum(n), the interval up to the nth event,% divided by the average interevent interval over the range from n = 0 to n = N % The deviation from expectation is n - this expectation. R is the value% of n at which this deviation is maximalN = (1:length(Cum))'; % Event count vectorSlopes = N./Cum;	% Average slope up to given point in cumulative functionDg = flipud(cumsum(flipud(eye(length(Cum)))));% Mask with ones on and above diagonal & zeros belowDiagonal = Dg .* repmat(Slopes',length(Slopes),1);% Creates an array in which successive cols have successive slopes of the cumulative record.% The slope for a given col fills all the cells on and above the main diagonalPreds = repmat(Cum,1,length(Cum)).*Diagonal;% Creates diagonal array of the predicted numbers of events at each time in Cum	Obs = repmat(N,1,length(Cum)).*Dg; % Diagonal array with actual numbers of eventsDevs = abs(Obs-Preds); % Diagonal array of deviations from expectations[mx R]=max(Devs); % mx is a row vector listing the maximum in each col% R is a row vector specifying the row in which the max occursR=R'; % Converts R to col vector